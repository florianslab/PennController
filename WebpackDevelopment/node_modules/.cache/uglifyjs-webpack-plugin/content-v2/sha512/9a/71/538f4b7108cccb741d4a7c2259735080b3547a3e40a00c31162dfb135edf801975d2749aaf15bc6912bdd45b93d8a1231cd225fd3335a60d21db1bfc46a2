{"code":"!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,\"__esModule\",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=0)}([function(e,t,n){var i,r=n(!function(){var e=new Error('Cannot find module \"jszip\"');throw e.code=\"MODULE_NOT_FOUND\",e}()),s=n(!function(){var e=new Error('Cannot find module \"jszip-utils\"');throw e.code=\"MODULE_NOT_FOUND\",e}());!function(){var t=function(){let e=c.length,t=arguments;return u.id=e,u.sequence=t,c.push(u),u={},{instructions:t,id:e}};t.Configure=function(e){for(parameter in e)parameter.indexOf.Configure<0&&(t[parameter]=e[parameter])},t.AddHost=function(){t.hasOwnProperty(\"hosts\")||(t.hosts=[]);for(let e=0;e<arguments.length;e++)\"string\"==typeof arguments[e]&&arguments[e].match(/^https?:\\/\\//i)?t.hosts.push(arguments[e]):console.log(\"Warning: host #\"+e+\" is not a valid URL.\",arguments[e])};var n=new Object,o=null,u={},c=[],h=[{}],d=[],p={},m=[],g={},w=!0,v=[],b=\"Please wait while the resources are preloading. This process may take up to 2 minutes.\",P=!0,k=!0,_=!0,E=!0,O={};const x=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;function C(e,t,i){if(null==t&&(t=o.element),!(e instanceof jQuery&&t instanceof jQuery))return n;if(t==o.element&&(e=$(\"<div>\").append(e)),i instanceof Function&&x){let n=new x(t=>{0!==t[0].addedNodes.length&&-1!==Array.prototype.indexOf.call(t[0].addedNodes,e[0])&&(n.disconnect(),i())});n.observe(t[0],{childList:!0})}t.append(e)}function R(e){let t=[],r=[];if(e.options.preload.hasOwnProperty(0))for(let t in e.options.preload){let n=e.options.preload[t];\"number\"!=typeof n&&(\"string\"==typeof n&&(n=(n=>n==e.options.preload[t])),r.push(n))}else r=[anyType];let s=function(e){let t,n=[],i={};for(let t in e){let r=e[t];if(r[0]instanceof Array){if(r[0].length>1){let e=r[0][1];i.hasOwnProperty(e)||(i[e]=[]),i[e].push(r)}}else n.push(r)}t=\"undefined\"!=typeof counterOverride?counterOverride:__counter_value_from_server__;for(let e=0;e<Object.keys(i).length;e++){let r=i[Object.keys(i)[e]],s=(t%r.length+e)%r.length;n.push(r[s])}return n}(i);for(let e in s){let n=s[e],i=n[0];i instanceof Array&&(i=n[0][0]);let o=!1;for(l in r)if(r[l](i)){o=!0;break}if(!o)continue;let a=!1;for(let e in n){if(0==e)continue;let i=n[e];a&&(a=!1,i instanceof Object&&i.hasOwnProperty(\"id\")&&(t=t.concat(c[i.id].preloadingInstructions))),e>0&&\"PennController\"==i&&(a=!0)}}let o=$(\"<div id='waitWhilePreloading'>\").append(b);e.element.append(o);for(let n in t){let i=t[n];i&&d.indexOf(i)>=0&&(e.toPreload||(e.toPreload=[]),e.toPreload.indexOf(i)<0&&(e.toPreload.push(i),i._setResource=i.extend(\"_setResource\",function(){let t=e.toPreload.indexOf(i);t>=0&&e.toPreload.splice(t,1),e.toPreload.length<=0&&jQuery.contains(document,o[0])&&(o.remove(),e.finishedCallback())})))}return(!e.toPreload||e.toPreload.length<=0)&&jQuery.contains(document,o[0])?(o.remove(),e.finishedCallback()):setTimeout(function(){if(!jQuery.contains(document,o[0]))return n;o.remove(),e.finishedCallback()},e.options.timeout),n}t.FeedItems=function(r,s){if(r instanceof Function&&void 0==s){let s=function(){function i(t){return $.csv||function(){RegExp.escape=function(e){return e.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g,\"\\\\$&\")},function(){\"use strict\";var t;(t=\"undefined\"!=typeof jQuery&&jQuery?jQuery:{}).csv={defaults:{separator:\",\",delimiter:'\"',headers:!0},hooks:{castToScalar:function(e,t){if(isNaN(e))return e;if(/\\./.test(e))return parseFloat(e);var n=parseInt(e);return isNaN(n)?null:n}},parsers:{parse:function(e,t){var n=t.separator,i=t.delimiter;t.state.rowNum||(t.state.rowNum=1),t.state.colNum||(t.state.colNum=1);var r=[],s=[],o=0,a=\"\",l=!1;function u(){if(o=0,a=\"\",t.start&&t.state.rowNum<t.start)return s=[],t.state.rowNum++,void(t.state.colNum=1);if(void 0===t.onParseEntry)r.push(s);else{var e=t.onParseEntry(s,t.state);!1!==e&&r.push(e)}s=[],t.end&&t.state.rowNum>=t.end&&(l=!0),t.state.rowNum++,t.state.colNum=1}function c(){if(void 0===t.onParseValue)s.push(a);else{var e=t.onParseValue(a,t.state);!1!==e&&s.push(e)}a=\"\",o=0,t.state.colNum++}var h=RegExp.escape(n),d=RegExp.escape(i),f=/(D|S|\\r\\n|\\n|\\r|[^DS\\r\\n]+)/,p=f.source;return p=(p=p.replace(/S/g,h)).replace(/D/g,d),f=new RegExp(p,\"gm\"),e.replace(f,function(e){if(!l)switch(o){case 0:if(e===n){a+=\"\",c();break}if(e===i){o=1;break}if(/^(\\r\\n|\\n|\\r)$/.test(e)){c(),u();break}a+=e,o=3;break;case 1:if(e===i){o=2;break}a+=e,o=1;break;case 2:if(e===i){a+=e,o=1;break}if(e===n){c();break}if(/^(\\r\\n|\\n|\\r)$/.test(e)){c(),u();break}throw new Error(\"CSVDataError: Illegal State [Row:\"+t.state.rowNum+\"][Col:\"+t.state.colNum+\"]\");case 3:if(e===n){c();break}if(/^(\\r\\n|\\n|\\r)$/.test(e)){c(),u();break}if(e===i)throw new Error(\"CSVDataError: Illegal Quote [Row:\"+t.state.rowNum+\"][Col:\"+t.state.colNum+\"]\");throw new Error(\"CSVDataError: Illegal Data [Row:\"+t.state.rowNum+\"][Col:\"+t.state.colNum+\"]\");default:throw new Error(\"CSVDataError: Unknown State [Row:\"+t.state.rowNum+\"][Col:\"+t.state.colNum+\"]\")}}),0!==s.length&&(c(),u()),r},splitLines:function(e,n){if(e){var i=(n=n||{}).separator||t.csv.defaults.separator,r=n.delimiter||t.csv.defaults.delimiter;n.state=n.state||{},n.state.rowNum||(n.state.rowNum=1);var s=[],o=0,a=\"\",l=!1,u=RegExp.escape(i),c=RegExp.escape(r),h=/(D|S|\\n|\\r|[^DS\\r\\n]+)/,d=h.source;return d=(d=d.replace(/S/g,u)).replace(/D/g,c),h=new RegExp(d,\"gm\"),e.replace(h,function(e){if(!l)switch(o){case 0:if(e===i){a+=e,o=0;break}if(e===r){a+=e,o=1;break}if(\"\\n\"===e){f();break}if(/^\\r$/.test(e))break;a+=e,o=3;break;case 1:if(e===r){a+=e,o=2;break}a+=e,o=1;break;case 2:var t=a.substr(a.length-1);if(e===r&&t===r){a+=e,o=1;break}if(e===i){a+=e,o=0;break}if(\"\\n\"===e){f();break}if(\"\\r\"===e)break;throw new Error(\"CSVDataError: Illegal state [Row:\"+n.state.rowNum+\"]\");case 3:if(e===i){a+=e,o=0;break}if(\"\\n\"===e){f();break}if(\"\\r\"===e)break;if(e===r)throw new Error(\"CSVDataError: Illegal quote [Row:\"+n.state.rowNum+\"]\");throw new Error(\"CSVDataError: Illegal state [Row:\"+n.state.rowNum+\"]\");default:throw new Error(\"CSVDataError: Unknown state [Row:\"+n.state.rowNum+\"]\")}}),\"\"!==a&&f(),s}function f(){if(o=0,n.start&&n.state.rowNum<n.start)return a=\"\",void n.state.rowNum++;if(void 0===n.onParseEntry)s.push(a);else{var e=n.onParseEntry(a,n.state);!1!==e&&s.push(e)}a=\"\",n.end&&n.state.rowNum>=n.end&&(l=!0),n.state.rowNum++}},parseEntry:function(e,t){var n=t.separator,i=t.delimiter;t.state.rowNum||(t.state.rowNum=1),t.state.colNum||(t.state.colNum=1);var r=[],s=0,o=\"\";function a(){if(void 0===t.onParseValue)r.push(o);else{var e=t.onParseValue(o,t.state);!1!==e&&r.push(e)}o=\"\",s=0,t.state.colNum++}if(!t.match){var l=RegExp.escape(n),u=RegExp.escape(i),c=/(D|S|\\n|\\r|[^DS\\r\\n]+)/.source;c=(c=c.replace(/S/g,l)).replace(/D/g,u),t.match=new RegExp(c,\"gm\")}return e.replace(t.match,function(e){switch(s){case 0:if(e===n){o+=\"\",a();break}if(e===i){s=1;break}if(\"\\n\"===e||\"\\r\"===e)break;o+=e,s=3;break;case 1:if(e===i){s=2;break}o+=e,s=1;break;case 2:if(e===i){o+=e,s=1;break}if(e===n){a();break}if(\"\\n\"===e||\"\\r\"===e)break;throw new Error(\"CSVDataError: Illegal State [Row:\"+t.state.rowNum+\"][Col:\"+t.state.colNum+\"]\");case 3:if(e===n){a();break}if(\"\\n\"===e||\"\\r\"===e)break;if(e===i)throw new Error(\"CSVDataError: Illegal Quote [Row:\"+t.state.rowNum+\"][Col:\"+t.state.colNum+\"]\");throw new Error(\"CSVDataError: Illegal Data [Row:\"+t.state.rowNum+\"][Col:\"+t.state.colNum+\"]\");default:throw new Error(\"CSVDataError: Unknown State [Row:\"+t.state.rowNum+\"][Col:\"+t.state.colNum+\"]\")}}),a(),r}},helpers:{collectPropertyNames:function(e){var t=[],n=[],i=[];for(t in e)for(n in e[t])e[t].hasOwnProperty(n)&&i.indexOf(n)<0&&\"function\"!=typeof e[t][n]&&i.push(n);return i}},toArray:function(e,n,i){n=void 0!==n?n:{};var r={};r.callback=void 0!==i&&\"function\"==typeof i&&i,r.separator=\"separator\"in n?n.separator:t.csv.defaults.separator,r.delimiter=\"delimiter\"in n?n.delimiter:t.csv.defaults.delimiter;var s=void 0!==n.state?n.state:{};n={delimiter:r.delimiter,separator:r.separator,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,state:s};var o=t.csv.parsers.parseEntry(e,n);if(!r.callback)return o;r.callback(\"\",o)},toArrays:function(e,n,i){n=void 0!==n?n:{};var r,s={};if(s.callback=void 0!==i&&\"function\"==typeof i&&i,s.separator=\"separator\"in n?n.separator:t.csv.defaults.separator,s.delimiter=\"delimiter\"in n?n.delimiter:t.csv.defaults.delimiter,void 0!==(n={delimiter:s.delimiter,separator:s.separator,onPreParse:n.onPreParse,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,onPostParse:n.onPostParse,start:n.start,end:n.end,state:{rowNum:1,colNum:1}}).onPreParse&&n.onPreParse(e,n.state),r=t.csv.parsers.parse(e,n),void 0!==n.onPostParse&&n.onPostParse(r,n.state),!s.callback)return r;s.callback(\"\",r)},toObjects:function(e,n,i){n=void 0!==n?n:{};var r={};r.callback=void 0!==i&&\"function\"==typeof i&&i,r.separator=\"separator\"in n?n.separator:t.csv.defaults.separator,r.delimiter=\"delimiter\"in n?n.delimiter:t.csv.defaults.delimiter,r.headers=\"headers\"in n?n.headers:t.csv.defaults.headers,n.start=\"start\"in n?n.start:1,r.headers&&n.start++,n.end&&r.headers&&n.end++;var s,o=[];n={delimiter:r.delimiter,separator:r.separator,onPreParse:n.onPreParse,onParseEntry:n.onParseEntry,onParseValue:n.onParseValue,onPostParse:n.onPostParse,start:n.start,end:n.end,state:{rowNum:1,colNum:1},match:!1,transform:n.transform};var a={delimiter:r.delimiter,separator:r.separator,start:1,end:1,state:{rowNum:1,colNum:1}};void 0!==n.onPreParse&&n.onPreParse(e,n.state);var l=t.csv.parsers.splitLines(e,a),u=t.csv.toArray(l[0],n);s=t.csv.parsers.splitLines(e,n),n.state.colNum=1,n.state.rowNum=u?2:1;for(var c=0,h=s.length;c<h;c++){for(var d=t.csv.toArray(s[c],n),f={},p=0;p<u.length;p++)f[u[p]]=d[p];void 0!==n.transform?o.push(n.transform.call(void 0,f)):o.push(f),n.state.rowNum++}if(void 0!==n.onPostParse&&n.onPostParse(o,n.state),!r.callback)return o;r.callback(\"\",o)},fromArrays:function(e,n,i){n=void 0!==n?n:{};var r={};r.callback=void 0!==i&&\"function\"==typeof i&&i,r.separator=\"separator\"in n?n.separator:t.csv.defaults.separator,r.delimiter=\"delimiter\"in n?n.delimiter:t.csv.defaults.delimiter;var s,o,a,l,u=\"\";for(a=0;a<e.length;a++){for(s=e[a],o=[],l=0;l<s.length;l++){var c=void 0===s[l]||null===s[l]?\"\":s[l].toString();c.indexOf(r.delimiter)>-1&&(c=c.replace(new RegExp(r.delimiter,\"g\"),r.delimiter+r.delimiter));var h=\"\\n|\\r|S|D\";h=(h=h.replace(\"S\",r.separator)).replace(\"D\",r.delimiter),c.search(h)>-1&&(c=r.delimiter+c+r.delimiter),o.push(c)}u+=o.join(r.separator)+\"\\r\\n\"}if(!r.callback)return u;r.callback(\"\",u)},fromObjects:function(e,n,i){n=void 0!==n?n:{};var r={};if(r.callback=void 0!==i&&\"function\"==typeof i&&i,r.separator=\"separator\"in n?n.separator:t.csv.defaults.separator,r.delimiter=\"delimiter\"in n?n.delimiter:t.csv.defaults.delimiter,r.headers=\"headers\"in n?n.headers:t.csv.defaults.headers,r.sortOrder=\"sortOrder\"in n?n.sortOrder:\"declare\",r.manualOrder=\"manualOrder\"in n?n.manualOrder:[],r.transform=n.transform,\"string\"==typeof r.manualOrder&&(r.manualOrder=t.csv.toArray(r.manualOrder,r)),void 0!==r.transform){var s,o=e;for(e=[],s=0;s<o.length;s++)e.push(r.transform.call(void 0,o[s]))}var a=t.csv.helpers.collectPropertyNames(e);if(\"alpha\"===r.sortOrder&&a.sort(),r.manualOrder.length>0){var l=[].concat(r.manualOrder);for(c=0;c<a.length;c++)l.indexOf(a[c])<0&&l.push(a[c]);a=l}var u,c,h,d,f=[];for(r.headers&&f.push(a),u=0;u<e.length;u++){for(h=[],c=0;c<a.length;c++)(d=a[c])in e[u]&&\"function\"!=typeof e[u][d]?h.push(e[u][d]):h.push(\"\");f.push(h)}return t.csv.fromArrays(f,n,r.callback)}},t.csvEntry2Array=t.csv.toArray,t.csv2Array=t.csv.toArrays,t.csv2Dictionary=t.csv.toObjects,void 0!==e&&e.exports&&(e.exports=t.csv)}.call(this)}(),t=$.csv.toObjects(t),Object.keys(t[0]).length>1?t:(t=$.csv.toObjects(CHUNKS_DICT[entry],{separator:\"\\t\"}),Object.keys(t[0]).length>1?t:null)}if(t.hasOwnProperty(\"defaultTable\")){let e=i(t.defaultTable);if(e)return e}for(let e in CHUNKS_DICT){if(e.match(/\\.(html?|mp3)$/i))continue;let t=i(CHUNKS_DICT[e]);if(t)return t}return n}();if(s==n)return n;s=new class{constructor(e){if(!(e instanceof Array)||e.length<2||Object.keys(e[0]).length<2)return n;this.table=e;for(let t in e[0])t.match(/^item$/i)&&(this.item=t),t.match(/^group$/i)&&(this.group=t),t.match(/^label$/i)&&(this.label=t)}setItem(e){if(!this.table[0].hasOwnProperty(e))return console.log(\"Error when setting table's item column: no column found with the name \"+e),n;this.item=e}setGroup(e){if(!this.table[0].hasOwnProperty(e))return console.log(\"Error when setting table's item column: no column found with the name \"+e),n;this.group=e}setLabel(e){if(!this.table[0].hasOwnProperty(e))return console.log(\"Error when setting table's item column: no column found with the name \"+e),n;this.label=e}}(s),i instanceof Array||(i=[]),i=i.concat(function(e,t){let i=[],r={};for(row in e.table){let n=t(e.table[row]);n instanceof Array||(n=[\"PennController\",n]);let s=[\"Item-\"+row];for(let e in n)s.push(n[e]);if(e.label&&e.table[row].hasOwnProperty(e.label)?s[0]=e.table[row][e.label]:e.item&&e.table[row].hasOwnProperty(e.item)&&(s[0]=\"Item-\"+e.table[row][e.item]),e.item&&e.group){let t=e.table[row][e.item],n=e.table[row][e.group];r.hasOwnProperty(t)||(r[t]={}),r[t][n]=s}else i.push(s)}if(e.item&&e.group){let e=Object.keys(r[Object.keys(r)[0]]);for(let t in r){for(let s in e){if(!r[t].hasOwnProperty(e[s]))return console.log(\"Error: item \"+t+\" has no entry for group \"+e[s]),n;let o=r[t][e[s]];o[0]=[o[0],t],i.push(o)}e.unshift(e.pop())}}return i}(s,r))}else if(\"string\"==typeof r)return n},t.CheckPreload=function(){E=!1;let e=arguments[Object.keys(arguments).length-1];return(\"number\"!=typeof e||e<=0)&&(e=12e4),{preload:arguments,timeout:e,countsForProgressBar:!1}},t.AutoPreload=function(e){\"images\"==e?(_=!1,P=!1,k=!0):\"audio\"==e?(P=!0,k=!1,_=!1):\"video\"==parameters?(_=!0,P=!1,k=!1):\"object\"==typeof e?(e.hasOwnProperty(\"images\")&&(k=e.images),e.hasOwnProperty(\"audio\")&&(P=e.audio),e.hasOwnProperty(\"videos\")&&(_=e.videos)):(P=!0,k=!0,_=!0)},t.PreloadZip=function(){for(let e in arguments)m.push(arguments[e])},$(document).ready(function(){!function(){if(m.length){var e=function(e){function t(){let t=m.indexOf(e);if(t>=0&&m.splice(t,1),m.length<=0)for(f in console.log(g),v)v[f]instanceof Function&&v[f].call()}var n=new r;s.getBinaryContent(e,function(i,r){if(i)throw t(),i;n.loadAsync(r).then(function(){console.log(\"Download of \"+e+\" complete\");var i=0;n.forEach(function(e,r){r.async(\"arraybuffer\").then(function(r){if(!e.match(/__MACOS.+\\/\\.[^\\/]+$/)){let t=e.replace(/^.*?([^\\/]+)$/,\"$1\"),n=\"\";t.match(/\\.(wav|mp3|ogg)$/i)?n=\"audio/\"+t.replace(/^.+\\.([^.]+)$/,\"$1\").replace(/mp3/i,\"mpeg\").toLowerCase():t.match(/\\.(png|jpe?g|gif)$/i)&&(n=\"image/\"+t.replace(/^.+\\.([^.]+)$/,\"$1\").replace(/jpg/i,\"jpeg\").toLowerCase()),n.length>0&&(g[t]={blob:new Blob([r],{type:n}),type:n})}++i>=Object.keys(n.files).length&&t()})})})})};for(let t in m){let n=m[t],i=n.match(/^https?:\\/\\/.+\\.(zip)$/i);\"string\"==typeof n&&i?\"zip\"==i[1].toLowerCase()&&e(n):console.log(\"Warning (Preload): entry #\"+t+\" is not a valid URL, ignoring it\")}}}(),function(){var e=document.createElement(\"script\");e.src=\"https://www.youtube.com/iframe_api\";var t=document.getElementsByTagName(\"script\")[0];t.parentNode.insertBefore(e,t),function(){for(y in O)O[y].call()}}()});class N{constructor(e,t){this.type=t,this.content=e,this.hasBeenRun=!1,this.isDone=!1,this.parentElement=null,this.element=null,this.origin=this,this.itvlWhen=null,this.resource=null,this.j={},u.hasOwnProperty(\"instructions\")||(u.instructions=[]),u.instructions.push(this)}setElement(e){this.element=e;let t=this;for(let e in this.origin.element)\"function\"==typeof t.origin.element[e]?t.j[e]=function(){return t.origin.element[e].apply(t.origin.element,arguments),t.newMeta(function(){this.done()})}:t.j[e]=function(){return t.origin.element[e]}}_addToPreload(){if(this.origin.resource)return n;d.indexOf(this.origin)<0&&d.push(this.origin),u.hasOwnProperty(\"preloadingInstructions\")||(u.preloadingInstructions=[]),u.preloadingInstructions.indexOf(this.origin)<0&&u.preloadingInstructions.push(this.origin)}_setResource(e){if(this.origin.resource)return console.log(\"Warning: trying to replace resource for \"+this.origin.content+\"; several host copies of the same file? Ignoring new resource.\"),n;let t=d.indexOf(this.origin);t>=0&&d.splice(t,1),this.origin.resource=e}fetchResource(e,i){let r,s,o=this;if(this.origin.resource)return n;if(w&&m.length>0&&!e.match(/^http/i))return void v.push(function(){o.fetchResource(e,i)});let a=\"load\";if(g.hasOwnProperty(e))i=g[e].type,s=URL.createObjectURL(g[e].blob),i.match(/audio/)&&(a=\"canplay\");else if(e.match(/^http/i)){let t=e.match(/\\.([^.]+)$/);if(!i&&!t)return console.log(\"Error: extension of resource \"+file+\" not recognized\"),n;t=t[1],\"audio\"==i||t.match(/mp3|ogg|wav/i)?(i=\"audio/\"+t.toLowerCase().replace(\"mp3\",\"mpeg\").toLowerCase(),s=e,a=\"canplaythrough\"):\"image\"==i||t.match(/gif|png|jpe?g/i)?(i=\"image/\"+t.replace(/jpg/i,\"jpeg\").toLowerCase(),s=e):\"video\"==i||t.match(/mp4|ogg|webm/i)}else if(t.hosts.length)for(let n in t.hosts)\"string\"==typeof t.hosts[n]&&t.hosts[n].match(/^http/i)&&o.fetchResource(t.hosts[n]+e,i);i.match(/audio/)?(r=$(\"<audio>\").append($(\"<source>\").attr({src:s,type:i})).css(\"display\",\"none\").attr({preload:\"auto\"})).get(0).readyState>4-(\"canplay\"==a)?o._setResource(r):r.one(a,function(){o._setResource(r)}):i.match(/image/)&&(r=$(\"<img>\").attr({src:s,type:i})).bind(a,function(){o.origin._setResource(r)}).bind(\"error\",function(){console.log(\"Warning: could not find image \"+e)})}done(){return this.isDone||!this.hasBeenRun?n:this.previousInstruction instanceof N&&!this.previousInstruction.isDone?n:(this.itvlWhen&&clearInterval(this.itvlWhen),void(this.isDone=!0))}run(){return this.hasBeenRun?n:this.previousInstruction instanceof N&&!this.previousInstruction.isDone?n:void(this.hasBeenRun=!0)}extend(e,t){let i=this,r=i[e];return function(){return r.apply(i,arguments)==n?n:t.apply(i,arguments)}}_whenToInsist(e){this.origin.clickable?this.origin.element.click(e):this.itvlWhen=setInterval(e,10)}when(e,t){return this.newMeta(function(){if(e())this.done();else{t instanceof N?(t.parentElement=o.element,t.run()):t instanceof Function&&t();let n=this;this._whenToInsist(function(){!n.isDone&&e()&&n.done()})}})}newMeta(e,t){let i=this,r=new this.origin.constructor(n);return r.sourceCallback=function(){let t=this;for(;t.source;){if(!t.source.isDone)return n;t=t.source}r.hasBeenRun=!0,\"function\"==typeof e&&e.apply(r,arguments)},r.before=function(){\"function\"==typeof t&&t.apply(r,arguments)},r.done=function(){if(N.prototype.done.apply(r)==n)return n;let e=this;for(;e.source;){if(!e.source.isDone)return n;e=e.source}},r.run=function(){if(N.prototype.run.apply(r)==n)return n;r.hasBeenRun=!1,r.before(),i.hasBeenRun?r.sourceCallback():(i.done=i.extend(\"done\",function(){r.sourceCallback()}),i.run())},r.type=\"meta\",r.source=i,r.setElement(i.element),r.origin=i.origin,r.toPreload=i.toPreload,r}remove(){return this.newMeta(function(){this.origin.element instanceof jQuery&&this.origin.element.detach(),this.done()})}move(e,t){return this.newMeta(function(){if(e instanceof N){let n=e.origin.element;for(;e instanceof S&&!n.is(\"table\");)n=n.parent();\"before\"==t?n.before(this.origin.element):n.after(this.origin.element)}this.done()})}resize(e,t){return this.newMeta(function(){this.origin.element.css({width:e,height:t}),this.done()})}center(){return this.newMeta(function(){this.origin.element.parent().css(\"text-align\",\"center\"),this.origin.element.css(\"text-align\",\"center\"),this.origin.element.css(\"margin\",\"auto\"),this.done()})}shift(e,t){return this.newMeta(function(){this.origin.element.css(\"position\").match(/static|relative/)?(this.origin.element.css(\"position\",\"relative\"),this.origin.element.css({left:e,top:t})):\"absolute\"==this.origin.element.css(\"position\")&&this.origin.element.css({left:this.origin.element.css(\"left\")+e,top:this.origin.element.css(\"top\")+t}),this.done()})}css(){let e=arguments;return this.newMeta(function(){this.origin.element.css.apply(this.origin.element,e),this.done()})}hide(e){return void 0===e&&(e=!0),this.newMeta(function(){e?this.origin.element.css(\"visibility\",\"hidden\"):this.origin.element.css(\"visibility\",\"visible\"),this.done()})}click(e){return this.newMeta(function(){this.origin.clickable=!0,this.origin.element.addClass(o.cssPrefix+\"clickable\");let t=this;this.origin.element.click(function(){e instanceof N?(e.parentElement=o.element,e.run()):e instanceof Function&&e.apply(o.variables),t.done()})})}id(e){return h[h.length-1][e]=this.origin,this.origin._id=e,this.newMeta(function(){this.done()})}}class D extends N{constructor(e){super(e,\"text\"),e!=n&&this.setElement($(\"<span>\").html(e))}run(){if(super.run()==n)return n;C(this.element,this.parentElement),this.done()}text(e){return this.newMeta(function(){this.origin.content=e,this.origin.element.html(e),this.done()})}}class L extends N{constructor(e){if(super(e,\"audio\"),e!=n){if(!e.match(/\\.(ogg|wav|mp3)$/i))return console.log(\"Error: \"+e+\" is not a valid audio file.\"),n;this.autoPlay=!0,this.controls=!1,this.ended=!1,this.eventsRecord=[],this.savePlays=!1,this.savePauses=!1,this.saveEnds=!1,this.saveSeeks=!1,this.setElement($(\"<span>\")),P&&this.origin._addToPreload(),this.origin.fetchResource(e,\"audio\")}}run(){if(super.run()==n)return n;if(this.audio){let e=this;this.origin.audio.bind(\"ended\",function(){e._whenEnded()}),this.audio.readyState<4&&d.indexOf(this.origin)>=0&&o.save(\"ERROR_PRELOADING_AUDIO\",this.content,Date.now(),\"Audio was not fully loaded\"),this.controls?(this.audio.attr(\"controls\",!0),this.audio.css(\"display\",\"inherit\")):this.audio.css(\"display\",\"none\"),this.element.append(this.audio),C(this.element,this.parentElement),this.autoPlay&&this.audio[0].play()}this.done()}_setResource(e){if(this.origin.audio)return n;if(super._setResource(e)==n)return n;let t=this.origin;this.origin.audio=e,e.bind(\"play\",function(){let n=setInterval(function(){!e[0].paused&&e[0].currentTime&&(t.eventsRecord.push([\"play\",Date.now(),e[0].currentTime]),clearInterval(n))},1)}).bind(\"ended\",function(){t.eventsRecord.push([\"end\",Date.now(),e[0].currentTime])}).bind(\"pause\",function(){t.eventsRecord.push([\"pause\",Date.now(),e[0].currentTime])}).bind(\"seeked\",function(){t.eventsRecord.push([\"seek\",Date.now(),e[0].currentTime])}),this.origin.hasBeenRun&&(this.origin.hasBeenRun=!1,this.origin.run())}_whenEnded(){this.origin.ended=!0}show(e){return void 0===e&&(e=!0),this.newMeta(function(){this.origin.controls=e,this.done()})}clickToStart(){return this.newMeta(function(){this.origin.controls||(this.origin.controls=!0),this.origin.auto=!1,this.done()})}wait(){if(this.origin.ended)return this.newMeta(function(){this.done()});let e=this.newMeta();return this.origin._whenEnded=this.origin.extend(\"_whenEnded\",function(){e.done()}),e}record(e){let t=this.origin,i=function(e){if(\"play\"==e){if(t.savePlays)return n;t.savePlays=!0}else if(\"pause\"==e){if(t.savePauses)return n;t.savePauses=!0}else if(\"end\"==e){if(t.saveEnds)return n;t.saveEnds=!0}else{if(\"seek\"!=e)return n;if(t.saveSeeks)return n;t.saveSeeks=!0}t.done=t.extend(\"done\",function(){o.callbackBeforeFinish(function(){for(let n in t.eventsRecord){let i=t.eventsRecord[n];i[0]==e&&o.save(t.content,i[0],i[1],i[2])}})})};if(1==arguments.length&&\"string\"==typeof e)i(e);else if(arguments.length>1)for(let e=0;e<arguments.length;e++)i(arguments[e]);else i(\"play\"),i(\"pause\"),i(\"end\"),i(\"seek\");return this.newMeta(function(){this.done()})}preload(){return this.origin._addToPreload(),this.newMeta(function(){this.done()})}}class I extends N{constructor(e,t,i){if(super(e,\"image\"),e!=n){let n=$(\"<div>\").css(\"display\",\"inline-block\");\"number\"==typeof t&&\"number\"==typeof i&&n.css({width:t,height:i}),this.setElement(n),this.image=null,k&&this.origin._addToPreload(),this.origin.fetchResource(e,\"image\")}}run(){if(super.run()==n)return n;C(this.element,this.parentElement),this.done()}_setResource(e){return this.origin.image?n:super._setResource(e)==n?n:(this.origin.image=e.clone(),this.origin.element.append(this.origin.image),void this.origin.image.css({width:\"100%\",height:\"100%\",display:\"inherit\"}))}move(e,t){return this.newMeta(function(){this.origin.element.css({left:e,top:t,position:\"absolute\"}),this.done()})}preload(){return this.origin._addToPreload(),this.newMeta(function(){this.done()})}}class S extends N{constructor(e){super(e,\"complex\"),e!=n&&(this.table=$(\"<table>\").addClass(\"PennController-Complex\"),this.toBeDone=[],this.setElement(this.table))}run(){if(super.run()==n)return n;let e=this,t=$(\"<tr>\");for(let n in this.content){let r=e.content[n],s=$(\"<td>\");function i(t){t.parentElement=t instanceof S?e.table:s,\"meta\"!=t.type||t.source.parentElement||i(t.source)}r instanceof N&&(r.hasBeenRun||(e.toBeDone.push(r),i(r),r instanceof S?(t.children().length&&e.table.append(t),t=$(\"<tr>\")):t.append(s),r.done=r.extend(\"done\",function(){e._executed(r)}),r.run()))}t.children().length&&e.table.append(t),this.parentElement&&this.parentElement.is(\"table\")?this.table.find(\"tr\").each(function(){C($(this),e.parentElement)}):this.element.is(\"table\")?C(this.element,this.parentElement):C($(\"<table>\").append(this.element),this.parentElement),this.toBeDone.length<1&&this.done()}_executed(e){let t=this.toBeDone.indexOf(e);t>=0&&this.toBeDone.splice(t,1),this.toBeDone.length<1&&$.contains(document.body,this.element[0])&&this.done()}newMeta(e){let t=this.origin.content;this.origin.content=null;let n=super.newMeta(e);return this.origin.content=t,n}validation(e){let t=this.newMeta();return this.origin._executed=this.origin.extend(\"_executed\",function(n){\"any\"==e?t.done():\"number\"==typeof e&&e in this.origin.content?t.origin.content[e]==n&&t.done():e instanceof N&&e==n?t.done():t.origin.isDone&&t.done()}),t}}class j extends N{constructor(e,t){super(e,\"timer\"),e!=n&&(this.delay=e,this.setElement($(\"<timer>\")),this.step=10,this.callback=t)}run(){if(super.run()==n)return n;this.left=this.delay;let e=this;this.timer=setTimeout(function(){e._elapsed()},this.delay),o.timers.push(this.timer),this.done()}_elapsed(){this.callback instanceof Function?this.callback():this.callback instanceof N&&(this.callback.parentElement=o.element,this.callback.run())}stop(e){let t=this,n=this.newMeta(function(){t.done});return n.run=function(){clearInterval(t.origin.timer),e&&t.origin.done()},n}step(e){return this.origin.step=e,this.newMeta(function(){this.done()})}wait(e){return this.newMeta(function(){let t=this;this.origin._elapsed=this.origin.extend(\"_elapsed\",function(){e instanceof N&&!e.hasBeenRun&&e.run(),t.done()})})}}t.instruction=function(e){switch(typeof e){case\"string\":return o&&h[o.id].hasOwnProperty(e)?h[o.id][e]:!o&&h[h.length-1].hasOwnProperty(e)?h[h.length-1][e]:e.match(/\\.(png|jpe?g|bmp|gif)$/i)?new I(e):e.match(/\\.(wav|ogg|mp3)$/i)?new L(e):new D(e);case\"number\":return new j(e);case\"function\":return new class extends N{constructor(e){super(e,\"function\"),e!=n&&(this.setElement($(\"<function>\")),this.func=e)}run(){if(super.run()==n)return n;this.func.apply(o.variables),this.done()}}(e);case\"object\":return new S(arguments)}},t.instruction.text=function(e){return new D(e)},t.instruction.image=function(e,t,n){return new I(e,t,n)},t.instruction.audio=function(e){return new L(e)},t.instruction.yt=function(e){return new class extends N{constructor(e){if(super(e,\"youtube\"),e!=n){let t=this,n=function(){t.origin.player=new YT.Player(e,{videoId:e,events:{onReady:function(e){t.origin._ready(e)},onStateChange:function(e){e.data==YT.PlayerState.ENDED?t.origin._ended(e):e.data==YT.PlayerState.BUFFERING?t.origin._buffering(e):e.data==YT.PlayerState.PLAYING?t.origin._playing(e):e.data==YT.PlayerState.CUED?t.origin._canPlay(e):e.data==YT.PlayerState.PAUSED&&t.origin._paused(e)}}})};this.iframeLoaded=!1,this.iframe=$(\"<iframe>\"),this.iframe.attr({src:\"https://www.youtube-nocookie.com/embed/\"+e+\"?enablejsapi=1\",id:e,frameborder:0}).bind(\"load\",function(){t.origin.iframeLoaded=!0}),$(\"html\").append(this.iframe.css({display:\"none\",position:\"absolute\"})),this.setElement($(\"<div>\")),O.hasOwnProperty(e)||(O[e]=function(){t.origin.iframeLoaded?n():t.origin.iframe.bind(\"load\",n)}),this.visual={top:0,left:0,width:0,height:0},this.autoPlay=!0,this.commandsQueue=[],this.hasPlayed=!1,_&&this.origin._addToPreload()}}run(){if(super.run()==n)return n;let e=this.origin;new x(function(t){if($.contains(document.body,e.element[0])&&e.element[0].offsetParent){let t=e.element.width(),n=e.element.height();t==e.visual.width&&n==e.visual.height||(e.iframe.css({width:t,height:n,display:\"block\"}),e.visual.width=t,e.visual.height=n);let i=e.element.offset(),r=i.left,s=i.top;r==e.visual.left&&s==e.visual.top||(e.iframe.css({left:r,top:s,display:\"block\"}),e.visual.left=r,e.visual.top=s)}}).observe(document.body,{childList:!0,attributes:!0,subtree:!0}),C(this.element,this.parentElement),e.origin.player&&e.origin.autoPlay&&e._play(),o.callbackBeforeFinish(function(){e._forcePause()})}_forcePlay(){let e=this.origin,t=0,n=setInterval(function(){e.player.getPlayerState()==YT.PlayerState.PLAYING||t>=5e3?clearInterval(n):e.player.playVideo(),t++},1)}_forcePause(){let e=this.origin,t=0,n=setInterval(function(){e.player.getPlayerState()==YT.PlayerState.PAUSED||e.player.getPlayerState()==YT.PlayerState.ENDED||t>=5e3?clearInterval(n):e.player.pauseVideo(),t++},1)}_play(){this.origin.player&&(this.origin.commandsQueue.push(\"play\"),this._forcePlay())}_pause(){this.origin.player&&(this.origin.commandsQueue.push(\"pause\"),this._forcePause())}_paused(e){0==this.origin.commandsQueue.indexOf(\"pause\")&&this.origin.commandsQueue.splice(0,1),this.origin.commandsQueue.length>0&&\"play\"==this.origin.commandsQueue[0]&&this._forcePlay()}_playing(e){0==this.origin.commandsQueue.indexOf(\"play\")&&this.origin.commandsQueue.splice(0,1),this.origin.commandsQueue.length>0&&\"pause\"==this.origin.commandsQueue[0]&&this.origin.player.pauseVideo(),this.origin.loaded||(this.origin.loaded=!0,this.origin.buffering&&!this.origin.canPlay&&this.origin._canPlay(e)),this.origin.buffering&&(this.origin.buffering=!1),this.origin.hasBeenRun&&!this.origin.isDone&&this.origin.done()}_buffering(e){this.origin.buffering||(this.origin.buffering=!0)}_canPlay(e){this.origin.canPlay||(this.origin.canPlay=!0,this.origin._setResource(this.iframe),this.hasBeenRun&&e.target.getPlayerState()!=YT.PlayerState.PLAYING?this._play():this.hasBeenRun||e.target.getPlayerState()!=YT.PlayerState.PLAYING||this._pause())}_ended(e){this.hasPlayed=!0}_ready(e){this._play()}wait(){if(this.origin.hasPlayed)return this.newMeta(function(){this.done()});let e=this.newMeta();return this.origin._ended=this.origin.extend(\"_ended\",function(){e.done()}),e}pause(){return this.newMeta(function(){this._pause(),this.done()})}play(){return this.newMeta(function(){this._play(),this.done()})}preload(){return this.origin._addToPreload(),this.newMeta(function(){this.done()})}}(e)},t.instruction.key=function(e){return new class extends N{constructor(e,t){if(super(e,\"key\"),e!=n)if(this.setElement($(\"<key>\")),this.keys=[],\"number\"==typeof e)this.keys.push(e);else if(\"string\"==typeof e)for(let n in e)if(t)this.keys.push(e.charCodeAt(n));else{let t=e.toUpperCase(),i=e.toLowerCase();this.keys.push(i.charCodeAt(n)),this.keys.push(t.charCodeAt(n))}}run(){if(super.run()==n)return n;let e=this;o.safeBind($(document),\"keydown\",function(t){(0==e.keys.length||e.keys.indexOf(t.keyCode)>=0)&&e._pressed(t.keyCode)})}_whenToInsist(e){this.origin._pressed=this.origin.extend(\"_pressed\",e)}_pressed(e){this.isDone||(this.origin.key=String.fromCharCode(e),this.origin.time=Date.now(),this.origin.done())}pressed(e){let t=this.origin;return function(){let n=t.key;return!!n&&(\"string\"==typeof e?RegExp(n,\"i\").test(e):\"number\"==typeof e?e==n.charCodeAt(0):n.charCodeAt(0))}}record(e){return this.newMeta(function(){let t=this;o.callbackBeforeFinish(function(){o.save(\"keypress\",t.origin.key,t.origin.time,e)}),this.done()})}}(e)},t.instruction.save=function(){return new class extends N{constructor(e){super(e,\"save\"),e!=n&&(this.setElement($(\"<save>\")),this.parameter=e[0],this.value=e[1],this.comment=e[2])}run(){if(super.run()==n)return n;o.save(this.parameter,this.value,Date.now(),this.comment),this.done()}}(arguments)},t.instruction.if=function(e,t,i){return new class extends N{constructor(e,t,i){super(arguments,\"if\"),e!=n&&(this.setElement($(\"<div>\").addClass(\"PennController-Condition\")),this.condition=e,this.success=t,this.failure=i)}run(){if(super.run()==n)return n;if(!this.success instanceof N)return n;if(!this.condition instanceof Function)return n;let e=this;this.condition()?(this.success.done=this.success.extend(\"done\",function(){e.done()}),this.success.run()):this.failure instanceof N?(this.failure.done=this.failure.extend(\"done\",function(){e.done()}),this.failure.run()):this.done()}}(e,t,i)},t.instruction.timer=function(e,t){return new j(e,t)},t.instruction.radioButtons=function(e,t){return new class extends N{constructor(e,t){if(super({label:e,length:t},\"radio\"),e!=n){this.label=e,this.length=t,this.values=[],this.times=[],this.setElement($(\"<span>\"));for(let n=0;n<t;n++){let t=this,i=$(\"<input type='radio'>\").attr({name:e,value:n});i.click(function(){t._clicked($(this).attr(\"value\"))}),t.element.append(i)}}}run(){if(super.run()==n)return n;C(this.element,this.parentElement),this.done()}_whenToInsist(e){this._clicked=this.extend(\"_clicked\",e)}_clicked(e){this.values.push(e),this.times.push(Date.now())}selected(e){let t=this.origin;return function(){let n=t.values[t.values.length-1];return void 0===e?n:\"number\"==typeof e||\"string\"==typeof e?n==e:e instanceof Array?e.indexOf(n)>=0||e.indexOf(parseInt(n))>=0:void 0}}wait(e){let t=this.newMeta();return this.origin._clicked=this.origin.extend(\"_clicked\",function(n){\"number\"==typeof e?n==e&&t.done():e instanceof Array?e.indexOf(n)>=0&&t.done():t.done()}),t}record(e,t){let n=this.origin;return this.newMeta(function(){o.callbackBeforeFinish(function(){if(\"string\"!=typeof e||\"last\"==e)o.save(n.label,n.values[n.values.length-1],n.times[n.times.length-1],t);else if(\"first\"==e&&1==n.values.length)o.save(n.label,n.values[0],n.times[0],t);else if(\"all\"==e)for(let e in n.values)o.save(n.label,n.values[e],n.times[e],t)}),this.done()})}}(e,t)},t.instruction.clear=function(){return new class extends N{constructor(){super(\"clear\",\"clear\")}run(){super.run(),this.hasBeenRun=!0,$(\".PennController-PennController div\").detach(),this.done()}}},t.instruction.selector=function(){return new class extends N{constructor(e){super(e,\"selector\"),e!=n&&(this.instructions=e,this.shuffledInstructions=e,this.enabled=!0,this.canClick=!0,this.keyList=[],this.shuffledKeyList=[],this.selectedElement=null,this.selectedInstruction=null,this.callbackFunction=null,this.setElement($(\"<div>\").addClass(\"PennController-Selector\")),this.selections=[])}run(){if(super.run()==n)return n;let e=this;for(let t in this.instructions){let n=this.instructions[t];n instanceof N?(n.origin.hasBeenRun||(n.origin.parentElement=this.element),n.hasBeenRun||n.run(),n.origin.element.bind(\"click\",function(){e.canClick&&e._select(n)})):console.log(\"Warning: selector's entry #\"+t+\" is not a proper instruction.\")}o.safeBind($(document),\"keydown\",function(t){if(!e.keyList.length)return n;for(let n in e.shuffledKeyList)(\"number\"==typeof e.shuffledKeyList[n]&&e.shuffledKeyList[n]==t.keyCode||e.shuffledKeyList[n]instanceof Array&&e.shuffledKeyList[n].indexOf(t.keyCode)>=0)&&e._select(e.shuffledInstructions[n])}),C(this.element,this.parentElement),this.done()}_select(e){if(!this.enabled)return n;let t=this.origin;if(e instanceof N){t.selectedElement=e.origin.element,t.selectedInstruction=e.origin,e.origin.element.addClass(\"PennController-selected\");for(let n in t.instructions)t.instructions[n].origin==e.origin?e.origin._id?t.selections.push([e.origin._id,Date.now()]):t.selections.push([n,Date.now()]):t.instructions[n].origin.element!=e.element&&t.instructions[n].origin.element.removeClass(\"PennController-selected\");t.callbackFunction instanceof Function&&t.callbackFunction(e)}}selected(e){let t=this.origin,n=arguments;return function(){if(n.hasOwnProperty(\"1\")){for(a in n)if(n[a]instanceof N&&n[a].origin==t.selectedInstruction)return!0;return!1}return e instanceof N?e.origin==t.selectedInstruction:t.selectedInstruction}}select(e){return this.newMeta(function(){this.origin._select(e),this.done()})}clickable(e){return this.newMeta(function(){this.origin.canClick=e,this.done()})}callback(e){return this.newMeta(function(){this.origin._select=this.origin.extend(\"_select\",function(){e instanceof N?e.run():e instanceof Function&&e.apply(o.variables,[this.origin.selectedInstruction])}),this.done()})}keys(){let e=arguments;return this.newMeta(function(){if(e.hasOwnProperty(\"0\")){if(\"string\"==typeof e[0]){let t=e.hasOwnProperty(\"1\");for(let n=0;n<e[0].length;n++)this.origin.instructions.hasOwnProperty(n)&&(t?this.origin.keyList.push(e[0].charCodeAt(n)):this.origin.keyList.push([e[0].toUpperCase().charCodeAt(n),e[0].toLowerCase().charCodeAt(n)]))}if(\"number\"==typeof e[0])for(let t in e)e[t]<0?console.log(\"Warning: invalid key code for selector instruction #\"+t+\", not attaching keys to it.\"):this.origin.keyList.push(e[t])}this.origin.shuffledKeyList=this.origin.keyList,this.done()})}shuffle(e){let t=this.origin;return this.newMeta(function(){let n=[];if(void 0===e)for(let e in t.instructions)n.push(e);else for(let e in arguments){let i=arguments[e];if(\"number\"==typeof i&&t.instructions.hasOwnProperty(i)&&n.indexOf(i)<0)n.push(i);else if(i instanceof N)for(let e in this.origin.instructions)t.instructions[e].origin==i.origin&&n.indexOf(e)<0&&n.push(e)}let i=[].concat(n);fisherYates(n),t.shuffledInstructions=$.extend({},t.instructions),t.shuffledKeyList=[].concat(t.keyList);for(let e in n){let r=i[e],s=n[e],o=t.instructions[s].origin;t.shuffledInstructions[r]=t.instructions[s],r<t.keyList.length&&(t.shuffledKeyList[r]=t.keyList[s]);let a=$(\"<shuffle>\").attr(\"id\",r).css({position:t.instructions[s].origin.element.css(\"position\"),left:t.instructions[s].origin.element.css(\"left\"),top:t.instructions[s].origin.element.css(\"top\")});o.element.before(a)}$(\"shuffle\").each(function(){let e=$(this).attr(\"id\");$(this).after(t.instructions[e].origin.element),t.instructions[e].origin.element.css({position:$(this).css(\"position\"),left:$(this).css(\"left\"),top:$(this).css(\"top\")})}),$(\"shuffle\").remove(),this.done()})}once(){let e=this.origin;return e._select=e.extend(\"_select\",function(){e.enabled=!1}),this.newMeta(function(){this.done()})}enable(e){return void 0===e&&(e=!0),this.newMeta(function(){this.origin.enabled=e,this.done()})}record(e){return this.newMeta(function(){let t=this.origin;o.callbackBeforeFinish(function(){if(!t.selections.length)return n;if(\"string\"==typeof e)if(\"first\"==e)o.save(\"selection\",t.selections[0][0],t.selections[0][1],\"NULL\");else if(\"last\"==e)o.save(\"selection\",t.selections[t.selections.length-1][0],t.selections[t.selections.length-1][1],\"NULL\");else for(let e in t.selections)o.save(\"selection\",t.selections[e][0],t.selections[e][1],\"NULL\");else for(let e in t.selections)o.save(\"selection\",t.selections[e][0],t.selections[e][1],\"NULL\")}),this.done()})}wait(){return this.newMeta(function(){let e=this;this.origin.selected().call()?this.done():this.origin._select=this.origin.extend(\"_select\",function(){e.done()})})}}(arguments)},t.instruction.canvas=function(e,t){return new class extends N{constructor(e,t){if(super({width:e,height:t},\"canvas\"),e!=n){if(\"number\"!=typeof e||\"number\"!=typeof t||e<0||t<0)return n;let i=$(\"<div>\").css({width:e,height:t,position:\"relative\"}).addClass(\"PennController-Canvas\");this.setElement(i),this.objects=[]}}run(){if(super.run()==n)return n;for(let e in this.objects){let t=this.objects[e],n=t[0];n instanceof N?n.hasBeenRun||(n.run(),n.done=n.extend(\"done\",function(){n.element.css({position:\"absolute\",left:t[1],top:t[2],\"z-index\":t[3]})})):console.log(\"Warning: element #\"+e+\" of canvas is not a proper instruction; ignoring it.\")}C(this.element,this.parentElement),this.done()}_addObject(e,t,i,r){if(\"number\"!=typeof t||\"number\"!=typeof i)return n;if(!(e instanceof N))return n;let s=e.origin,o=!1;for(let e in this.origin.objects){let n=this.origin.objects[e];n[0]==s&&(n[1]=t,n[2]=i,\"number\"==typeof r&&(n[3]=r),o=!0)}o||this.origin.objects.push([s,t,i,\"number\"==typeof r?r:this.origin.objects.length]),s.parentElement=this.origin.element,e.hasBeenRun&&e.isDone?(s.element.appendTo(this.origin.element),s.element.css({position:\"absolute\",left:t,top:i,\"z-index\":r})):this.origin.hasBeenRun&&(s.done=s.extend(\"done\",function(){s.element.css({position:\"absolute\",left:t,top:i,\"z-index\":r})}),e.run())}put(e,t,n,i){return this.newMeta(function(){this.origin._addObject(e,t,n,i),this.done()})}}(e,t)},t.instruction.end=function(){return new class extends N{constructor(){super(\"end\",\"end\")}run(){super.run(),this.hasBeenRun=!0,this.done=!0,o.end()}}},define_ibex_controller({name:\"PennController\",jqueryWidget:{_init:function(){var e=this;if(e.cssPrefix=e.options._cssPrefix,e.utils=e.options._utils,e.finishedCallback=e.options._finishedCallback,e.options.hasOwnProperty(\"preload\"))return R(e);if(e.instructions=e.options.instructions,e.id=e.options.id,e.toSave=[],e.toRunBeforeFinish=[],e.timers=[],e.save=function(t,n,i,r){e.toSave.push([[\"Parameter\",t],[\"Value\",n],[\"Time\",i],[\"Comment\",r||\"NULL\"]])},e.callbackBeforeFinish=function(t){e.toRunBeforeFinish.push(t)},e.end=function(){for(f in e.toRunBeforeFinish)e.toRunBeforeFinish[f]();for(let e in p)p[e].parent().is(\"html\")||(p[e].css(\"display\",\"none\"),p[e].appendTo($(\"html\")));$(\"iframe\").css(\"display\",\"none\"),$(\"audio\").each(function(){this.pause(),this.currentTime=0});for(let e in this.timers)clearInterval(this.timers[e]),clearTimeout(this.timers[e]);e.save(\"Page\",\"End\",Date.now(),\"NULL\"),e.finishedCallback(e.toSave)},e.addToPreload=function(t){t&&d.indexOf(t)>=0&&(e.toPreload||(e.toPreload=[]),e.toPreload.indexOf(t)<0&&(e.toPreload.push(t),t._setResource=t.extend(\"_setResource\",function(){let n=e.toPreload.indexOf(t);n>=0&&e.toPreload.splice(n,1),e.toPreload.length<=0&&($(\"#waitWhilePreloading\").remove(),e.save(\"Preload\",\"Complete\",Date.now(),\"NULL\"),e.instructions[0].hasBeenRun||e.instructions[0].run())})))},!E&&c[this.id].hasOwnProperty(\"preloadingInstructions\"))for(let t in c[this.id].preloadingInstructions)e.addToPreload(c[this.id].preloadingInstructions[t]);let t;for(let n in e.instructions){let i=e.instructions[n];i instanceof N&&(i.parentElement=e.element,t instanceof N&&(t.done=t.extend(\"done\",function(){i.run()}),i.previousInstruction=t),t=i)}if(t.done=t.extend(\"done\",function(){e.end()}),e.instructions[0].run=e.instructions[0].extend(\"run\",function(){e.save(\"Page\",\"RunFirstInstruction\",Date.now(),\"NULL\")}),(o=e).variables={},E&&d.length)for(let t in d)e.addToPreload(t);e.toPreload?(e.save(\"Preload\",\"Start\",Date.now(),\"NULL\"),e.element.append($(\"<div id='waitWhilePreloading'>\").html(b)),setTimeout(function(){if(e.instructions[0].hasBeenRun)return n;$(\"#waitWhilePreloading\").remove(),e.save(\"Preload\",\"Timeout\",Date.now(),\"NULL\"),e.instructions[0].hasBeenRun||e.instructions[0].run()},12e4)):e.instructions[0].run(),e.save(\"Page\",\"Creation\",Date.now(),\"NULL\")}},properties:{obligatory:[],countsForProgressBar:!0,htmlDescription:null}}),window.PennController=t}()}]);","extractedComments":[]}